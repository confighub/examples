#!/bin/bash

instance_name=$1
if [ -z "$instance_name" ]; then
  echo "Usage: $0 <instance_name>"
  exit 1
fi

aws ssm start-session --target $(aws ec2 describe-instances \
  --filters "Name=tag:Name,Values=$instance_name" \
  "Name=instance-state-name,Values=running" \
  --query 'Reservations[0].Instances[0].InstanceId' \
  --output text)
